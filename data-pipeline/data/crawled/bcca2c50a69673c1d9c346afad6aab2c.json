{
    "id": "bcca2c50a69673c1d9c346afad6aab2c",
    "metadata": {
        "id": "bcca2c50a69673c1d9c346afad6aab2c",
        "url": "https://github.com/avr2002/sagemaker/blob/feat/sagemaker-processing-job/pipeline.py/",
        "title": "sagemaker/pipeline.py at feat/sagemaker-processing-job · avr2002/sagemaker · GitHub",
        "properties": {
            "description": "MLOps using AWS Sagemaker. Contribute to avr2002/sagemaker development by creating an account on GitHub.",
            "keywords": null,
            "author": null,
            "og:image": "https://opengraph.githubassets.com/503641cd45f9ff69d7b9b869dc58f9f93df5ca8dbf5ffe8b0def2f77f1a999a6/avr2002/sagemaker",
            "og:image:alt": "MLOps using AWS Sagemaker. Contribute to avr2002/sagemaker development by creating an account on GitHub.",
            "og:image:width": "1200",
            "og:image:height": "600",
            "og:site_name": "GitHub",
            "og:type": "object",
            "og:title": "sagemaker/pipeline.py at feat/sagemaker-processing-job · avr2002/sagemaker",
            "og:url": "https://github.com/avr2002/sagemaker/blob/feat/sagemaker-processing-job/pipeline.py",
            "og:description": "MLOps using AWS Sagemaker. Contribute to avr2002/sagemaker development by creating an account on GitHub.",
            "twitter:image": "https://opengraph.githubassets.com/503641cd45f9ff69d7b9b869dc58f9f93df5ca8dbf5ffe8b0def2f77f1a999a6/avr2002/sagemaker",
            "twitter:site": "@github",
            "twitter:card": "summary_large_image",
            "twitter:title": "sagemaker/pipeline.py at feat/sagemaker-processing-job · avr2002/sagemaker",
            "twitter:description": "MLOps using AWS Sagemaker. Contribute to avr2002/sagemaker development by creating an account on GitHub."
        }
    },
    "parent_metadata": {
        "id": "e1afc34aff6bafb1d4cefcc03b0c0db3",
        "url": "https://www.notion.so/SageMaker-e1afc34aff6bafb1d4cefcc03b0c0db3",
        "title": "SageMaker",
        "properties": {
            "Type": "Leaf"
        }
    },
    "content": "[Skip to content](#start-of-content)\n\n## Navigation Menu\n\nToggle navigation\n\n[ ](/)\n\n[ Sign in ](/login?return_to=https%3A%2F%2Fgithub.com%2Favr2002%2Fsagemaker%2Fblob%2Ffeat%2Fsagemaker-processing-job%2Fpipeline.py%2F)\n\n  * Product \n\n    * [ GitHub Copilot Write better code with AI  ](https://github.com/features/copilot)\n    * [ Security Find and fix vulnerabilities  ](https://github.com/features/security)\n    * [ Actions Automate any workflow  ](https://github.com/features/actions)\n    * [ Codespaces Instant dev environments  ](https://github.com/features/codespaces)\n    * [ Issues Plan and track work  ](https://github.com/features/issues)\n    * [ Code Review Manage code changes  ](https://github.com/features/code-review)\n    * [ Discussions Collaborate outside of code  ](https://github.com/features/discussions)\n    * [ Code Search Find more, search less  ](https://github.com/features/code-search)\n\nExplore\n    * [ All features ](https://github.com/features)\n    * [ Documentation ](https://docs.github.com)\n    * [ GitHub Skills ](https://skills.github.com)\n    * [ Blog ](https://github.blog)\n\n  * Solutions \n\nBy company size\n    * [ Enterprises ](https://github.com/enterprise)\n    * [ Small and medium teams ](https://github.com/team)\n    * [ Startups ](https://github.com/enterprise/startups)\n    * [ Nonprofits ](/solutions/industry/nonprofits)\n\nBy use case\n    * [ DevSecOps ](/solutions/use-case/devsecops)\n    * [ DevOps ](/solutions/use-case/devops)\n    * [ CI/CD ](/solutions/use-case/ci-cd)\n    * [ View all use cases ](/solutions/use-case)\n\nBy industry\n    * [ Healthcare ](/solutions/industry/healthcare)\n    * [ Financial services ](/solutions/industry/financial-services)\n    * [ Manufacturing ](/solutions/industry/manufacturing)\n    * [ Government ](/solutions/industry/government)\n    * [ View all industries ](/solutions/industry)\n\n[ View all solutions ](/solutions)\n\n  * Resources \n\nTopics\n    * [ AI ](/resources/articles/ai)\n    * [ DevOps ](/resources/articles/devops)\n    * [ Security ](/resources/articles/security)\n    * [ Software Development ](/resources/articles/software-development)\n    * [ View all ](/resources/articles)\n\nExplore\n    * [ Learning Pathways ](https://resources.github.com/learn/pathways)\n    * [ White papers, Ebooks, Webinars ](https://resources.github.com)\n    * [ Customer Stories ](https://github.com/customer-stories)\n    * [ Partners ](https://partner.github.com)\n    * [ Executive Insights ](https://github.com/solutions/executive-insights)\n\n  * Open Source \n\n    * [ GitHub Sponsors Fund open source developers  ](/sponsors)\n\n    * [ The ReadME Project GitHub community articles  ](https://github.com/readme)\n\nRepositories\n    * [ Topics ](https://github.com/topics)\n    * [ Trending ](https://github.com/trending)\n    * [ Collections ](https://github.com/collections)\n\n  * Enterprise \n\n    * [ Enterprise platform AI-powered developer platform  ](/enterprise)\n\nAvailable add-ons\n    * [ Advanced Security Enterprise-grade security features  ](https://github.com/enterprise/advanced-security)\n    * [ GitHub Copilot Enterprise-grade AI features  ](/features/copilot#enterprise)\n    * [ Premium Support Enterprise-grade 24/7 support  ](/premium-support)\n\n  * [Pricing](https://github.com/pricing)\n\n\n\nSearch or jump to...\n\n# Search code, repositories, users, issues, pull requests...\n\nSearch \n\nClear\n\n[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)\n\n#  Provide feedback \n\nWe read every piece of feedback, and take your input very seriously.\n\nInclude my email address so I can be contacted\n\nCancel  Submit feedback \n\n#  Saved searches \n\n## Use saved searches to filter your results more quickly\n\nName\n\nQuery\n\nTo see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax). \n\nCancel  Create saved search \n\n[ Sign in ](/login?return_to=https%3A%2F%2Fgithub.com%2Favr2002%2Fsagemaker%2Fblob%2Ffeat%2Fsagemaker-processing-job%2Fpipeline.py%2F)\n\n[ Sign up ](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=avr2002%2Fsagemaker) Reseting focus\n\nYou signed in with another tab or window. [Reload]() to refresh your session. You signed out in another tab or window. [Reload]() to refresh your session. You switched accounts on another tab or window. [Reload]() to refresh your session. Dismiss alert\n\n{{ message }}\n\n[ avr2002 ](/avr2002) / **[sagemaker](/avr2002/sagemaker) ** Public\n\n  * [ Notifications ](/login?return_to=%2Favr2002%2Fsagemaker) You must be signed in to change notification settings\n  * [ Fork 0 ](/login?return_to=%2Favr2002%2Fsagemaker)\n  * [ Star  0 ](/login?return_to=%2Favr2002%2Fsagemaker)\n\n\n\n\n  * [ Code ](/avr2002/sagemaker/tree/feat/sagemaker-processing-job)\n  * [ Issues 0 ](/avr2002/sagemaker/issues)\n  * [ Pull requests 0 ](/avr2002/sagemaker/pulls)\n  * [ Actions ](/avr2002/sagemaker/actions)\n  * [ Projects 0 ](/avr2002/sagemaker/projects)\n  * [ Security ](/avr2002/sagemaker/security)\n  * [ Insights ](/avr2002/sagemaker/pulse)\n\n\n\nAdditional navigation options\n\n  * [ Code  ](/avr2002/sagemaker/tree/feat/sagemaker-processing-job)\n  * [ Issues  ](/avr2002/sagemaker/issues)\n  * [ Pull requests  ](/avr2002/sagemaker/pulls)\n  * [ Actions  ](/avr2002/sagemaker/actions)\n  * [ Projects  ](/avr2002/sagemaker/projects)\n  * [ Security  ](/avr2002/sagemaker/security)\n  * [ Insights  ](/avr2002/sagemaker/pulse)\n\n\n\n## Files\n\nfeat/sagemaker-processing-job\n\n  * .vscode\n\n  * data\n\n  * notebooks\n\n  * src\n\n  * .dockerignore\n\n  * .gitignore\n\n  * .pre-commit-config.yaml\n\n  * Dockerfile\n\n  * Makefile\n\n  * README.md\n\n  * docker-compose.yaml\n\n  * pipeline.py\n\n  * pyproject.toml\n\n  * requirements.txt\n\n  * run.sh\n\n  * uv.lock\n\n\n\n\n## Breadcrumbs\n\n  1. [sagemaker](/avr2002/sagemaker/tree/feat/sagemaker-processing-job)\n\n\n\n/\n\n# pipeline.py\n\nCopy path\n\nBlame\n\nBlame\n\n## Latest commit\n\n[![avr2002](https://avatars.githubusercontent.com/u/82011740?v=4&size=40)](/avr2002)[avr2002](/avr2002/sagemaker/commits?author=avr2002)\n\n[trying to run processing job using docker container: Getting permissi…](/avr2002/sagemaker/commit/cdc430e9ad51bd8fe8b33d77f424c9bc5d316212)\n\nJan 22, 2025\n\n[cdc430e](/avr2002/sagemaker/commit/cdc430e9ad51bd8fe8b33d77f424c9bc5d316212) · Jan 22, 2025\n\n## History\n\n[History](/avr2002/sagemaker/commits/feat/sagemaker-processing-job/pipeline.py)\n\n[](/avr2002/sagemaker/commits/feat/sagemaker-processing-job/pipeline.py)\n\n156 lines (130 loc) · 4.87 KB\n\n## Breadcrumbs\n\n  1. [sagemaker](/avr2002/sagemaker/tree/feat/sagemaker-processing-job)\n\n\n\n/\n\n# pipeline.py\n\nTop\n\n## File metadata and controls\n\n  * Code\n\n  * Blame\n\n\n\n\n156 lines (130 loc) · 4.87 KB\n\n[Raw](https://github.com/avr2002/sagemaker/raw/refs/heads/feat/sagemaker-processing-job/pipeline.py)\n\n103\n\nimport os import platform from pathlib import Path import boto3 from dotenv import load_dotenv # from sagemaker.local import LocalSession from sagemaker.processing import ( # FrameworkProcessor, ProcessingInput, ProcessingOutput, Processor, ) # from sagemaker.sklearn.processing import SKLearnProcessor from sagemaker.workflow.parameters import ParameterString from sagemaker.workflow.pipeline import Pipeline from sagemaker.workflow.pipeline_context import ( LocalPipelineSession, PipelineSession, ) from sagemaker.workflow.pipeline_definition_config import PipelineDefinitionConfig from sagemaker.workflow.steps import ( CacheConfig, ProcessingStep, ) from penguins.consts import ( BUCKET, LOCAL_MODE, S3_LOCATION, SAGEMAKER_EXECUTION_ROLE, SAGEMAKER_PROCESSING_DIR, ) # from sagemaker.sklearn.estimator import SKLearn load_dotenv() # Constants THIS_DIR: Path = Path(__file__).resolve().parent SOURCE_DIR: str = str(THIS_DIR / \"src\") # Get the architecture of the local machine architecture = platform.machine() IS_ARM64_ARCHITECTURE = architecture == \"arm64\" def get_ecr_image_uri(repository_name, region=\"ap-south-1\"): client = boto3.client(\"ecr\", region_name=region) response = client.describe_repositories() for repo in response[\"repositories\"]: if repo[\"repositoryName\"] == repository_name: return repo[\"repositoryUri\"] raise ValueError(f\"Repository {repository_name} not found in {region}.\") REPOSITORY_NAME = \"processing-job\" ECR_IMAGE_URI = get_ecr_image_uri(REPOSITORY_NAME) # Sagemaker Session Setup pipeline_session: LocalPipelineSession | PipelineSession = ( LocalPipelineSession(default_bucket=BUCKET) if LOCAL_MODE else PipelineSession(default_bucket=BUCKET) ) if isinstance(pipeline_session, LocalPipelineSession): pipeline_session.config = {\"local\": {\"local_code\": True}} config = { \"session\": pipeline_session, \"instance_type\": \"local\" if LOCAL_MODE else \"ml.m5.xlarge\", \"image\": \"sagemaker-tensorflow-toolkit-local\" if LOCAL_MODE and IS_ARM64_ARCHITECTURE else None, \"framework_version\": \"2.12\", \"py_version\": \"py310\", } # Parameters pipeline_definition_config = PipelineDefinitionConfig(use_custom_job_prefix=True) dataset_location = ParameterString(name=\"dataset_location\", default_value=f\"{S3_LOCATION}/data\") processor: Processor = Processor( image_uri=ECR_IMAGE_URI, role=SAGEMAKER_EXECUTION_ROLE, instance_count=1, instance_type=config[\"instance_type\"], sagemaker_session=config[\"session\"], env={ \"S3_BUCKET_NAME\": os.environ[\"S3_BUCKET_NAME\"], \"SAGEMAKER_EXECUTION_ROLE\": os.environ[\"SAGEMAKER_EXECUTION_ROLE\"], \"LOCAL_MODE\": os.environ[\"LOCAL_MODE\"], \"AWS_REGION\": \"ap-south-1\", \"AWS_DEFAULT_REGION\": \"ap-south-1\", }, ) # Enable caching in Processing Step cache_config: CacheConfig = CacheConfig(enable_caching=True, expire_after=\"15d\") # Define the processing step preprocessing_step = ProcessingStep( name=\"preprocess-data\", step_args=processor.run( inputs=[ProcessingInput(source=dataset_location, destination=f\"{str(SAGEMAKER_PROCESSING_DIR)}/input\")], outputs=[ ProcessingOutput( output_name=\"train\", source=f\"{str(SAGEMAKER_PROCESSING_DIR)}/train\", destination=f\"{S3_LOCATION}/preprocessing/train\", ), ProcessingOutput( output_name=\"validation\", source=f\"{str(SAGEMAKER_PROCESSING_DIR)}/validation\", destination=f\"{S3_LOCATION}/preprocessing/validation\", ), ProcessingOutput( output_name=\"test\", source=f\"{str(SAGEMAKER_PROCESSING_DIR)}/test\", destination=f\"{S3_LOCATION}/preprocessing/test\", ), ProcessingOutput( output_name=\"model\", source=f\"{str(SAGEMAKER_PROCESSING_DIR)}/model\", destination=f\"{S3_LOCATION}/preprocessing/model\", ), ProcessingOutput( output_name=\"train-baseline\", source=f\"{str(SAGEMAKER_PROCESSING_DIR)}/train-baseline\", destination=f\"{S3_LOCATION}/preprocessing/train-baseline\", ), ProcessingOutput( output_name=\"test-baseline\", source=f\"{str(SAGEMAKER_PROCESSING_DIR)}/test-baseline\", destination=f\"{S3_LOCATION}/preprocessing/test-baseline\", ), ], ), cache_config=cache_config, ) # Pipeline Definition pipeline: Pipeline = Pipeline( name=\"penguins-preprocessing-pipeline\", parameters=[dataset_location], steps=[preprocessing_step], pipeline_definition_config=pipeline_definition_config, sagemaker_session=config[\"session\"], ) pipeline.upsert(role_arn=SAGEMAKER_EXECUTION_ROLE) if __name__ == \"__main__\": pipeline.start()\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\n21\n\n22\n\n23\n\n24\n\n25\n\n26\n\n27\n\n28\n\n29\n\n30\n\n31\n\n32\n\n33\n\n34\n\n35\n\n36\n\n37\n\n38\n\n39\n\n40\n\n41\n\n42\n\n43\n\n44\n\n45\n\n46\n\n47\n\n48\n\n49\n\n50\n\n51\n\n52\n\n53\n\n54\n\n55\n\n56\n\n57\n\n58\n\n59\n\n60\n\n61\n\n62\n\n63\n\n64\n\n65\n\n66\n\n67\n\n68\n\n69\n\n70\n\n71\n\n72\n\n73\n\n74\n\n75\n\n76\n\n77\n\n78\n\n79\n\n80\n\n81\n\n82\n\n83\n\n84\n\n85\n\n86\n\n87\n\n88\n\n89\n\n90\n\n91\n\n92\n\n93\n\n94\n\n95\n\n96\n\n97\n\n98\n\n99\n\n100\n\n101\n\n102\n\n103\n\n104\n\n105\n\n106\n\n107\n\n108\n\n109\n\n110\n\n111\n\n112\n\n113\n\n114\n\n115\n\n116\n\n117\n\n118\n\n119\n\n120\n\n121\n\n122\n\n123\n\n124\n\n125\n\n126\n\n127\n\n128\n\n129\n\n130\n\n131\n\n132\n\n133\n\n134\n\n135\n\n136\n\n137\n\n138\n\n139\n\n140\n\n141\n\n142\n\n143\n\n144\n\n145\n\n146\n\n147\n\n148\n\n149\n\n150\n\n151\n\n152\n\n153\n\n154\n\n155\n\n156\n\n## Footer\n\n[ ](https://github.com \"GitHub\") © 2025 GitHub, Inc. \n\n### Footer navigation\n\n  * [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)\n  * [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)\n  * [Security](https://github.com/security)\n  * [Status](https://www.githubstatus.com/)\n  * [Docs](https://docs.github.com/)\n  * [Contact](https://support.github.com?tags=dotcom-footer)\n  * Manage cookies \n  * Do not share my personal information \n\n\n\nYou can’t perform that action at this time. \n\nWhile the code is focused, press Alt+F1 for a menu of operations.\n",
    "content_quality_score": 0.6,
    "summary": null,
    "child_urls": [
        "https://github.com/avr2002/sagemaker/blob/feat/sagemaker-processing-job/pipeline.py/#start-of-content",
        "https://github.com/",
        "https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2Favr2002%2Fsagemaker%2Fblob%2Ffeat%2Fsagemaker-processing-job%2Fpipeline.py%2F",
        "https://github.com/features/copilot",
        "https://github.com/features/security",
        "https://github.com/features/actions",
        "https://github.com/features/codespaces",
        "https://github.com/features/issues",
        "https://github.com/features/code-review",
        "https://github.com/features/discussions",
        "https://github.com/features/code-search",
        "https://github.com/features",
        "https://docs.github.com",
        "https://skills.github.com",
        "https://github.com/enterprise",
        "https://github.com/team",
        "https://github.com/enterprise/startups",
        "https://github.com/solutions/industry/nonprofits",
        "https://github.com/solutions/use-case/devsecops",
        "https://github.com/solutions/use-case/devops",
        "https://github.com/solutions/use-case/ci-cd",
        "https://github.com/solutions/use-case",
        "https://github.com/solutions/industry/healthcare",
        "https://github.com/solutions/industry/financial-services",
        "https://github.com/solutions/industry/manufacturing",
        "https://github.com/solutions/industry/government",
        "https://github.com/solutions/industry",
        "https://github.com/solutions",
        "https://github.com/resources/articles/ai",
        "https://github.com/resources/articles/devops",
        "https://github.com/resources/articles/security",
        "https://github.com/resources/articles/software-development",
        "https://github.com/resources/articles",
        "https://resources.github.com/learn/pathways",
        "https://resources.github.com",
        "https://github.com/customer-stories",
        "https://partner.github.com",
        "https://github.com/solutions/executive-insights",
        "https://github.com/sponsors",
        "https://github.com/readme",
        "https://github.com/topics",
        "https://github.com/trending",
        "https://github.com/collections",
        "https://github.com/enterprise/advanced-security",
        "https://github.com/features/copilot#enterprise",
        "https://github.com/premium-support",
        "https://github.com/pricing",
        "https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax",
        "https://github.com/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=avr2002%2Fsagemaker",
        "https://github.com/avr2002",
        "https://github.com/avr2002/sagemaker",
        "https://github.com/login?return_to=%2Favr2002%2Fsagemaker",
        "https://github.com/avr2002/sagemaker/tree/feat/sagemaker-processing-job",
        "https://github.com/avr2002/sagemaker/issues",
        "https://github.com/avr2002/sagemaker/pulls",
        "https://github.com/avr2002/sagemaker/actions",
        "https://github.com/avr2002/sagemaker/projects",
        "https://github.com/avr2002/sagemaker/security",
        "https://github.com/avr2002/sagemaker/pulse",
        "https://github.com/avr2002/sagemaker/commits?author=avr2002",
        "https://github.com/avr2002/sagemaker/commit/cdc430e9ad51bd8fe8b33d77f424c9bc5d316212",
        "https://github.com/avr2002/sagemaker/commits/feat/sagemaker-processing-job/pipeline.py",
        "https://github.com/avr2002/sagemaker/raw/refs/heads/feat/sagemaker-processing-job/pipeline.py",
        "https://github.com",
        "https://docs.github.com/site-policy/github-terms/github-terms-of-service",
        "https://docs.github.com/site-policy/privacy-policies/github-privacy-statement",
        "https://github.com/security",
        "https://docs.github.com/",
        "https://support.github.com?tags=dotcom-footer",
        "https://github.blog",
        "https://www.githubstatus.com/"
    ]
}